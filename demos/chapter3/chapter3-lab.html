<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A Deeper Dive into Simple Programs</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Warm Neutrals (Stone, Zinc, Amber) -->
    <!-- Application Structure Plan: The SPA uses a two-column layout. A sticky left-hand navigation menu allows users to jump directly to different "labs" for Cellular Automata, Head-Based Systems (Mobile Automata/Turing Machines), and Growth Systems (Tag/Substitution). This structure facilitates direct comparison and focused exploration, which is ideal for a user already familiar with the basic concepts. The main content area for each lab contains interactive simulators and detailed textual explanations drawn from the chapter, allowing for a hands-on experience. The final section synthesizes the core thesis on universality. This is a more powerful and less linear structure than a simple scroll, promoting deeper user engagement. -->
    <!-- Visualization & Content Choices: 
        - Report Info: Cellular Automata evolution. -> Goal: Explore & Compare. -> Viz/Method: Interactive Canvas simulator. -> Interaction: Select from a curated list of key rules (e.g., 30, 90, 110, 45, 73) and initial conditions (single cell, random). -> Justification: Provides a hands-on "lab" environment for direct experimentation, going beyond static examples. -> Library: Vanilla JS Canvas API.
        - Report Info: Mobile Automata & Turing Machine behavior. -> Goal: Understand sequential evolution and complexity. -> Viz/Method: Dual Canvas rendering (full evolution + compressed view). -> Interaction: Select system type and a specific complex rule. -> Justification: The compressed view is a key analytical tool in the chapter; visualizing it alongside the full evolution is highly instructive. -> Library: Vanilla JS Canvas API.
        - Report Info: Growth patterns in various systems. -> Goal: Compare quantitative behavior. -> Viz/Method: Interactive Line Chart. -> Interaction: Select system type (Tag, Substitution, Register Machine) and a specific rule to see its growth signature (chaotic, exponential, nested). -> Justification: A dynamic chart makes the abstract concept of growth patterns tangible and easy to compare across different underlying mechanics. -> Library: Chart.js/Canvas.
        - Report Info: The Principle of Universality. -> Goal: Synthesize. -> Viz/Method: Interactive concept map using styled HTML. -> Interaction: Clicking a core concept (e.g., "Randomness") highlights all relevant interactive demos on the page. -> Justification: Creates a cohesive summary that links the abstract principles back to the concrete, interactive examples the user has just explored. -> Library: Vanilla JS.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        :root {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: #FAFAFA;
            color: #27272A;
        }

        /* zinc-50, zinc-800 */
        .nav-link {
            transition: all 0.2s ease-in-out;
        }

        .nav-link.active {
            color: #D97706;
            /* amber-600 */
            font-weight: 600;
            border-left-color: #D97706;
        }

        .lab-control-button.active {
            background-color: #D97706;
            color: white;
        }

        .highlight-concept {
            transition: all 0.3s;
        }

        .highlight-concept.highlighted {
            box-shadow: 0 0 0 3px #FBBF24;
            /* amber-400 */
            border-radius: 0.75rem;
        }

        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            height: 350px;
            max-height: 450px;
        }

        @media (min-width: 768px) {
            .chart-container {
                height: 400px;
            }
        }
    </style>
</head>

<body class="antialiased">

    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
        <div class="lg:grid lg:grid-cols-[280px_1fr] lg:gap-12">
            <aside class="hidden lg:block sticky top-0 self-start py-12">
                <nav class="flex flex-col space-y-2">
                    <h3 class="px-3 text-sm font-semibold text-zinc-500 uppercase tracking-wider">Exploration Labs</h3>
                    <a href="#cellular-lab"
                        class="nav-link px-3 py-2 text-zinc-600 hover:text-amber-600 border-l-2 border-transparent">Cellular
                        Automata</a>
                    <a href="#head-based-lab"
                        class="nav-link px-3 py-2 text-zinc-600 hover:text-amber-600 border-l-2 border-transparent">Head-Based
                        Systems</a>
                    <a href="#growth-lab"
                        class="nav-link px-3 py-2 text-zinc-600 hover:text-amber-600 border-l-2 border-transparent">Growth
                        & Substitution</a>
                    <a href="#universality-lab"
                        class="nav-link px-3 py-2 text-zinc-600 hover:text-amber-600 border-l-2 border-transparent">Principle
                        of Universality</a>
                </nav>
            </aside>

            <main class="py-12">
                <section id="intro-section" class="mb-16">
                    <h1 class="text-4xl font-bold text-zinc-900">A Deeper Dive into Simple Programs</h1>
                    <p class="mt-4 text-lg text-zinc-600">This interactive exhibit expands on the core thesis of Chapter
                        3: that the universe of simple programs is filled with immense complexity, and this complexity
                        arises from universal principles that are independent of the specific mechanics of the programs
                        themselves. Here, you can directly experiment with the systems discussed and observe these
                        principles in action.</p>
                </section>

                <section id="cellular-lab" class="mb-16 scroll-mt-20">
                    <h2 class="text-3xl font-bold text-zinc-900 mb-2">Lab 1: Cellular Automata</h2>
                    <p class="text-zinc-600 mb-8">Cellular Automata update all their cells in parallel at each step.
                        This lab allows you to explore the emergent behavior of different elementary rules and initial
                        conditions. Observe how tiny changes in the rule can lead to fundamentally different outcomes,
                        from perfect order to complete chaos.</p>

                    <div class="bg-white p-6 rounded-xl shadow-md border border-zinc-200">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                            <div>
                                <label for="caRuleSelector" class="block text-sm font-medium text-zinc-700">Select
                                    Rule:</label>
                                <select id="caRuleSelector"
                                    class="mt-1 block w-full p-2 border border-zinc-300 rounded-md bg-zinc-50 focus:ring-2 focus:ring-amber-500">
                                    <option value="30" selected>Rule 30 (Randomness)</option>
                                    <option value="90">Rule 90 (Nesting)</option>
                                    <option value="110">Rule 110 (Complexity)</option>
                                    <option value="45">Rule 45 (Randomness/Repetition)</option>
                                    <option value="73">Rule 73 (Complex Regularity)</option>
                                </select>
                            </div>
                            <div>
                                <label for="caInitialCondition" class="block text-sm font-medium text-zinc-700">Initial
                                    Condition:</label>
                                <select id="caInitialCondition"
                                    class="mt-1 block w-full p-2 border border-zinc-300 rounded-md bg-zinc-50 focus:ring-2 focus:ring-amber-500">
                                    <option value="single" selected>Single Black Cell</option>
                                    <option value="random">Random</option>
                                </select>
                            </div>
                            <div class="flex items-end">
                                <button id="caRunButton"
                                    class="w-full bg-amber-500 text-white font-semibold py-2 px-4 rounded-md hover:bg-amber-600 transition">Run
                                    Simulation</button>
                            </div>
                        </div>
                        <div class="flex justify-center bg-zinc-100 p-2 rounded-lg">
                            <canvas id="caCanvas" class="rounded-md" width="600" height="300"></canvas>
                        </div>
                        <div id="caRuleDescription"
                            class="mt-4 text-center text-zinc-600 max-w-2xl mx-auto highlight-concept"
                            data-concept="randomness complexity nesting"></div>
                    </div>
                </section>

                <section id="head-based-lab" class="mb-16 scroll-mt-20">
                    <h2 class="text-3xl font-bold text-zinc-900 mb-2">Lab 2: Head-Based Systems</h2>
                    <p class="text-zinc-600 mb-8">Unlike Cellular Automata, Mobile Automata and Turing Machines update
                        only a single "active cell" or "head" at each step. This sequential nature makes complex
                        behavior rarer, but still possible. This lab visualizes both the full evolution and the
                        "compressed" history, which only shows steps where the head reaches a new position, revealing
                        the underlying structure of the computation.</p>

                    <div class="bg-white p-6 rounded-xl shadow-md border border-zinc-200">
                        <div class="flex items-center justify-center gap-4 mb-6">
                            <label for="hbRuleSelector" class="text-sm font-medium text-zinc-700">Select System &
                                Rule:</label>
                            <select id="hbRuleSelector"
                                class="p-2 border border-zinc-300 rounded-md bg-zinc-50 focus:ring-2 focus:ring-amber-500">
                                <option value="ma-random" selected>Mobile Automaton (Random Walk)</option>
                                <option value="tm-random">Turing Machine (Random Pattern)</option>
                                <option value="tm-nested">Turing Machine (Nested)</option>
                            </select>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 text-center">
                            <div>
                                <h4 class="font-semibold mb-2">Full Evolution (First 500 steps)</h4>
                                <div class="flex justify-center bg-zinc-100 p-2 rounded-lg">
                                    <canvas id="hbCanvasFull" class="rounded-md" width="300" height="400"></canvas>
                                </div>
                            </div>
                            <div>
                                <h4 class="font-semibold mb-2">Compressed Evolution (First 500 new positions)</h4>
                                <div class="flex justify-center bg-zinc-100 p-2 rounded-lg">
                                    <canvas id="hbCanvasCompressed" class="rounded-md" width="300"
                                        height="400"></canvas>
                                </div>
                            </div>
                        </div>
                        <div id="hbRuleDescription"
                            class="mt-4 text-center text-zinc-600 max-w-2xl mx-auto highlight-concept"
                            data-concept="randomness nesting"></div>
                    </div>
                </section>

                <section id="growth-lab" class="mb-16 scroll-mt-20">
                    <h2 class="text-3xl font-bold text-zinc-900 mb-2">Lab 3: Growth & Substitution</h2>
                    <p class="text-zinc-600 mb-8">Systems like Substitution and Tag systems can change the number of
                        elements they contain at each step. Their complexity is often revealed in their growth patterns.
                        Explore how different rules lead to predictable exponential growth, nested fluctuations, or
                        chaotic changes in size.</p>

                    <div class="bg-white p-6 rounded-xl shadow-md border border-zinc-200">
                        <h4 class="text-xl font-semibold text-center mb-4">Comparing Growth Signatures</h4>
                        <div class="flex flex-wrap justify-center gap-2 md:gap-4 mb-6">
                            <button class="lab-control-button px-3 py-1.5 text-sm rounded-md transition data-btn active"
                                data-system="tag-complex">Tag (Complex)</button>
                            <button class="lab-control-button px-3 py-1.5 text-sm rounded-md transition data-btn"
                                data-system="sub-fibonacci">Substitution (Fibonacci)</button>
                            <button class="lab-control-button px-3 py-1.5 text-sm rounded-md transition data-btn"
                                data-system="reg-nested">Register Machine (Nested)</button>
                        </div>
                        <div class="chart-container">
                            <canvas id="growthChart"></canvas>
                        </div>
                        <p id="growthDescription"
                            class="mt-4 text-center text-zinc-600 max-w-2xl mx-auto highlight-concept"
                            data-concept="randomness nesting"></p>
                    </div>
                </section>

                <section id="universality-lab" class="scroll-mt-20">
                    <h2 class="text-3xl font-bold text-zinc-900 mb-2">The Principle of Universality</h2>
                    <p class="text-zinc-600 mb-8">The overarching discovery is that the fundamental types of behavior
                        are universal. The details of the underlying rules change, but the emergent
                        phenomena—repetition, nesting, randomness, and localized structures—remain the same. Click on a
                        concept below to highlight the relevant interactive examples on this page.</p>

                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
                        <div class="concept-card bg-white p-4 rounded-xl shadow-md border border-zinc-200 cursor-pointer hover:shadow-lg transition"
                            data-concept="repetition">
                            <h4 class="font-semibold text-zinc-800">Repetition</h4>
                            <p class="text-sm text-zinc-600 mt-1">Systems that settle into simple, stable, or periodic
                                patterns.</p>
                        </div>
                        <div class="concept-card bg-white p-4 rounded-xl shadow-md border border-zinc-200 cursor-pointer hover:shadow-lg transition"
                            data-concept="nesting">
                            <h4 class="font-semibold text-zinc-800">Nesting</h4>
                            <p class="text-sm text-zinc-600 mt-1">Behavior that produces intricate but regular fractal
                                patterns.</p>
                        </div>
                        <div class="concept-card bg-white p-4 rounded-xl shadow-md border border-zinc-200 cursor-pointer hover:shadow-lg transition"
                            data-concept="randomness">
                            <h4 class="font-semibold text-zinc-800">Randomness</h4>
                            <p class="text-sm text-zinc-600 mt-1">Chaotic and unpredictable behavior emerging from
                                deterministic rules.</p>
                        </div>
                        <div class="concept-card bg-white p-4 rounded-xl shadow-md border border-zinc-200 cursor-pointer hover:shadow-lg transition"
                            data-concept="complexity">
                            <h4 class="font-semibold text-zinc-800">Complexity</h4>
                            <p class="text-sm text-zinc-600 mt-1">A mix of order and randomness, with localized
                                structures that interact.</p>
                        </div>
                    </div>
                </section>
            </main>
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- Navigation ---
            const sections = document.querySelectorAll('main section');
            const navLinks = document.querySelectorAll('.nav-link');
            const observer = new IntersectionObserver(entries => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        navLinks.forEach(link => {
                            link.classList.toggle('active', link.getAttribute('href') === `#${entry.target.id}`);
                        });
                    }
                });
            }, { rootMargin: '-50% 0px -50% 0px', threshold: 0 });
            sections.forEach(s => observer.observe(s));

            // --- Lab 1: Cellular Automata ---
            const ca = {
                canvas: document.getElementById('caCanvas'),
                ctx: document.getElementById('caCanvas').getContext('2d'),
                ruleSelector: document.getElementById('caRuleSelector'),
                initialSelector: document.getElementById('caInitialCondition'),
                runButton: document.getElementById('caRunButton'),
                description: document.getElementById('caRuleDescription'),
                cellSize: 4,
                width: 150, // 600 / 4
                height: 75, // 300 / 4
                rules: {
                    30: [0, 0, 0, 1, 1, 1, 1, 0].reverse(),
                    90: [0, 1, 0, 1, 1, 0, 1, 0].reverse(),
                    110: [0, 1, 1, 0, 1, 1, 1, 0].reverse(),
                    45: [0, 0, 1, 0, 1, 1, 0, 1].reverse(),
                    73: [0, 1, 0, 0, 1, 0, 0, 1].reverse()
                },
                descriptions: {
                    30: "Rule 30's chaotic evolution from a single cell is a classic example of randomness from simple rules.",
                    90: "Rule 90 produces a perfectly regular nested pattern known as the Sierpinski gasket.",
                    110: "Rule 110 supports complex localized structures that interact, making it capable of universal computation.",
                    45: "Rule 45 shows a mix of repetitive structures on the outside and chaotic behavior in the middle.",
                    73: "Rule 73 produces a complex but highly regular pattern with several distinct structural regions."
                },
                run: function () {
                    const rule = this.rules[this.ruleSelector.value];
                    const initialType = this.initialSelector.value;
                    let cells = new Array(this.width).fill(0);

                    if (initialType === 'single') {
                        cells[Math.floor(this.width / 2)] = 1;
                    } else {
                        cells = cells.map(() => Math.round(Math.random()));
                    }

                    this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
                    this.ctx.fillStyle = '#27272A';

                    for (let y = 0; y < this.height; y++) {
                        let nextCells = new Array(this.width).fill(0);
                        for (let x = 0; x < this.width; x++) {
                            if (cells[x] === 1) {
                                this.ctx.fillRect(x * this.cellSize, y * this.cellSize, this.cellSize, this.cellSize);
                            }
                            const left = cells[(x - 1 + this.width) % this.width];
                            const center = cells[x];
                            const right = cells[(x + 1) % this.width];
                            const index = left * 4 + center * 2 + right * 1;
                            nextCells[x] = rule[index];
                        }
                        cells = nextCells;
                    }
                    this.description.textContent = this.descriptions[this.ruleSelector.value];
                }
            };
            ca.runButton.addEventListener('click', () => ca.run());
            ca.run();

            // --- Lab 2: Head-Based Systems ---
            const hb = {
                fullCanvas: document.getElementById('hbCanvasFull'),
                compCanvas: document.getElementById('hbCanvasCompressed'),
                fullCtx: document.getElementById('hbCanvasFull').getContext('2d'),
                compCtx: document.getElementById('hbCanvasCompressed').getContext('2d'),
                selector: document.getElementById('hbRuleSelector'),
                description: document.getElementById('hbRuleDescription'),
                systems: {
                    'ma-random': {
                        type: 'ma',
                        rule: [[[1, 1, 1], [0, 1]], [[1, 1, 0], [0, 1]], [[1, 0, 1], [1, -1]], [[1, 0, 0], [0, -1]], [[0, 1, 1], [0, -1]], [[0, 1, 0], [0, 1]], [[0, 0, 1], [1, 1]], [[0, 0, 0], [1, -1]]],
                        desc: "This Mobile Automaton's active cell moves in a seemingly random walk, leaving a simple trail. The compressed view reveals the path is not purely random but has some structure."
                    },
                    'tm-random': {
                        type: 'tm',
                        rule: [[[1, 0], [2, 1, 1]], [[1, 1], [2, 1, -1]], [[2, 0], [3, 0, -1]], [[2, 1], [4, 1, 1]], [[3, 0], [4, 0, -1]], [[3, 1], [1, 0, -1]], [[4, 0], [1, 1, 1]], [[4, 1], [3, 0, 1]]],
                        desc: "This 4-state Turing Machine produces a central column of seemingly random colors. The compressed view shows the head sweeping back and forth over this growing random region."
                    },
                    'tm-nested': {
                        type: 'tm',
                        rule: [[[1, 0], [2, 1, 1]], [[1, 1], [2, 0, -1]], [[2, 0], [1, 1, -1]], [[2, 1], [1, 1, 1]]],
                        desc: "This 2-state Turing Machine produces a classic nested pattern. The compressed view makes the perfect regularity of the head's sweeps very clear."
                    }
                },
                run: function () {
                    const system = this.systems[this.selector.value];
                    this.description.textContent = system.desc;

                    this.fullCtx.clearRect(0, 0, this.fullCanvas.width, this.fullCanvas.height);
                    this.compCtx.clearRect(0, 0, this.compCanvas.width, this.compCanvas.height);

                    let tape = { 0: 0 };
                    let headPos = 0;
                    let state = 1;
                    let minPos = 0, maxPos = 0;
                    let compStep = 0;

                    for (let step = 0; step < 50000 && compStep < 400; step++) {
                        const currentVal = tape[headPos] || 0;
                        let new_state = state, new_val = currentVal, move = 0;

                        if (system.type === 'ma') {
                            const left = tape[headPos - 1] || 0;
                            const right = tape[headPos + 1] || 0;
                            const pattern = [left, currentVal, right];
                            for (let i = 0; i < system.rule.length; i++) {
                                if (system.rule[i][0].every((v, j) => v === pattern[j])) {
                                    [new_val, move] = system.rule[i][1];
                                    break;
                                }
                            }
                        } else { // tm
                            for (let i = 0; i < system.rule.length; i++) {
                                if (system.rule[i][0][0] === state && system.rule[i][0][1] === currentVal) {
                                    [new_state, new_val, move] = system.rule[i][1];
                                    break;
                                }
                            }
                        }

                        tape[headPos] = new_val;
                        state = new_state;
                        headPos += move;

                        if (step < 500) {
                            this.fullCtx.fillStyle = new_val ? '#27272A' : '#F4F4F5';
                            this.fullCtx.fillRect((headPos - minPos) * 2, step * 1, 2, 1);
                        }

                        if (headPos < minPos || headPos > maxPos) {
                            if (headPos < minPos) minPos = headPos;
                            if (headPos > maxPos) maxPos = headPos;

                            this.compCtx.fillStyle = new_val ? '#27272A' : '#F4F4F5';
                            this.compCtx.fillRect((headPos - minPos) * 2, compStep * 1, 2, 1);
                            compStep++;
                        }
                    }
                }
            };
            hb.selector.addEventListener('change', () => hb.run());
            hb.run();

            // --- Lab 3: Growth Chart ---
            const growth = {
                ctx: document.getElementById('growthChart').getContext('2d'),
                description: document.getElementById('growthDescription'),
                chart: null,
                data: {
                    'tag-complex': {
                        label: 'Tag System (Complex)',
                        desc: "This tag system's size fluctuates in a complex, seemingly random way, never settling into a simple pattern.",
                        values: [2, 3, 3, 2, 4, 4, 3, 5, 6, 6, 5, 7, 7, 6, 8, 9, 9, 8, 10, 10, 9, 11, 12, 12, 11, 13, 13, 12, 14, 15, 15, 14, 16],
                        color: 'rgba(217, 119, 6, 0.6)'
                    },
                    'sub-fibonacci': {
                        label: 'Substitution (Fibonacci)',
                        desc: "This substitution system exhibits smooth, predictable exponential growth, with sizes following the Fibonacci sequence.",
                        values: [1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144, 233, 377, 610, 987, 1597, 2584, 4181, 6765, 10946],
                        color: 'rgba(113, 113, 122, 0.6)'
                    },
                    'reg-nested': {
                        label: 'Register Machine (Nested)',
                        desc: "The value in this register machine grows in a stairstep fashion characteristic of nested, recursive processes.",
                        values: [0, 1, 2, 2, 3, 4, 5, 5, 6, 6, 7, 8, 9, 9, 10, 11, 11, 12, 13, 14, 14, 15, 15, 16, 17, 18, 18, 19, 20, 20, 21, 22, 23, 23, 24],
                        color: 'rgba(39, 39, 42, 0.6)'
                    }
                },
                create: function (systemId) {
                    const sysData = this.data[systemId];
                    if (this.chart) this.chart.destroy();
                    this.description.textContent = sysData.desc;
                    this.chart = new Chart(this.ctx, {
                        type: 'line',
                        data: {
                            labels: Array.from({ length: sysData.values.length }, (_, i) => i),
                            datasets: [{
                                label: sysData.label, data: sysData.values,
                                borderColor: sysData.color.replace('0.6', '1'),
                                backgroundColor: sysData.color, fill: true, tension: 0.1, pointRadius: 2
                            }]
                        },
                        options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'top' } } }
                    });
                }
            };
            document.querySelectorAll('.data-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    document.querySelectorAll('.data-btn').forEach(b => b.classList.remove('active'));
                    e.target.classList.add('active');
                    growth.create(e.target.dataset.system);
                });
            });
            growth.create('tag-complex');

            // --- Lab 4: Universality Concepts ---
            document.querySelectorAll('.concept-card').forEach(card => {
                card.addEventListener('click', () => {
                    const concept = card.dataset.concept;
                    document.querySelectorAll('.highlight-concept').forEach(el => {
                        if (el.dataset.concept.includes(concept)) {
                            el.classList.add('highlighted');
                            setTimeout(() => el.classList.remove('highlighted'), 2000);
                        }
                    });
                });
            });
        });
    </script>
</body>

</html>